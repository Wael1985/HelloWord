<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù‚Ø§Ù„Ø¨ Ø®Ø·Ø© Ø§Ù„Ø¯Ø±Ø³ Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© Ù„Ù„Ø£Ø·ÙØ§Ù„</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.8.2/docx.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap');

        body {
            font-family: 'Tajawal', sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f0f8ff;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='%239C92AC' fill-opacity='0.1'%3E%3Cpath opacity='.5' d='M96 95h4v1h-4v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9zm-1 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9z'/%3E%3Cpath d='M6 5V0H5v5H0v1h5v94h1V6h94V5H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }

        h1, h2 {
            color: #1e3a8a;
            text-align: center;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 30px;
            background: linear-gradient(45deg, #ff9a9e 0%, #fad0c4 99%, #fad0c4 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .section {
            background-color: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .section::before {
            content: '';
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            background: linear-gradient(45deg, #ff9a9e 0%, #fad0c4 99%, #fad0c4 100%);
            z-index: -1;
            filter: blur(20px);
            opacity: 0.7;
        }

        .section h2 {
            color: #1e3a8a;
            border-bottom: 2px solid #3b82f6;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        input, textarea, select {
            width: 100%;
            padding: 12px;
            margin-bottom: 15px;
            border: 2px solid #3b82f6;
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #1e40af;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5);
            transform: translateY(-2px);
        }

        button {
            background-color: #3b82f6;
            color: white;
            border: none;
            padding: 12px 20px;
            cursor: pointer;
            border-radius: 8px;
            margin-left: 10px;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        button:hover {
            background-color: #1e40af;
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .preview {
            border: 2px solid #3b82f6;
            padding: 20px;
            margin-top: 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .toolbar {
            margin-bottom: 15px;
            background-color: #dbeafe;
            padding: 10px;
            border-radius: 8px;
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .toolbar button {
            background-color: #60a5fa;
            margin: 0;
        }

        #toolSymbols {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }

        .tool-symbol {
            font-size: 2em;
            cursor: pointer;
            transition: all 0.3s ease;
            background-color: #e0f2fe;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .tool-symbol:hover {
            transform: scale(1.2);
            background-color: #bfdbfe;
        }

        #selectedTools {
            min-height: 50px;
            border: 2px dashed #3b82f6;
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 15px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .selected-tool {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin: 5px;
            padding: 5px 10px;
            background-color: #dbeafe;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .selected-tool:hover {
            background-color: #bfdbfe;
            transform: translateY(-2px);
        }

        @media print {
            body * {
                visibility: hidden;
            }
            .section, .section * {
                visibility: visible;
            }
            .section {
                position: absolute;
                left: 0;
                top: 0;
            }
        }
    </style>
</head>
<body>
    <h1>ğŸ¨ Ù…Ù†Ø´Ø¦ Ø®Ø·Ø© Ø§Ù„Ø¯Ø±Ø³ Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© Ù„Ù„Ø£Ø·ÙØ§Ù„ ğŸ“š</h1>
    
    <div class="section">
        <h2>ğŸ“ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¯Ø±Ø³</h2>
        <form id="lessonPlanForm">
            <input type="date" id="lessonDate" required>
            <input type="text" id="subject" placeholder="ğŸ“š Ø§Ù„Ù…Ø§Ø¯Ø©" required>
            <input type="text" id="grade" placeholder="ğŸ« Ø§Ù„ØµÙ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ" required>
            <input type="text" id="classPeriod" placeholder="â° Ø§Ù„Ø­ØµØ© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©" required>
            <input type="text" id="lessonTitle" placeholder="ğŸ“– Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯Ø±Ø³" required>
            <textarea id="introduction" placeholder="ğŸŒŸ Ø§Ù„Ù…Ù‚Ø¯Ù…Ø©" rows="3"></textarea>
            <textarea id="objectives" placeholder="ğŸ¯ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù" rows="3"></textarea>
            <h3>ğŸ› ï¸ Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø¯Ø±Ø³</h3>
            <div id="toolSymbols">
                <span class="tool-symbol" onclick="addTool('ğŸ“•')">ğŸ“•</span>
                <span class="tool-symbol" onclick="addTool('âœï¸')">âœï¸</span>
                <span class="tool-symbol" onclick="addTool('ğŸ“')">ğŸ“</span>
                <span class="tool-symbol" onclick="addTool('ğŸ–¥ï¸')">ğŸ–¥ï¸</span>
                <span class="tool-symbol" onclick="addTool('ğŸ§ª')">ğŸ§ª</span>
                <span class="tool-symbol" onclick="addTool('ğŸ¨')">ğŸ¨</span>
                <span class="tool-symbol" onclick="addTool('ğŸ”¬')">ğŸ”¬</span>
                <span class="tool-symbol" onclick="addTool('ğŸ§®')">ğŸ§®</span>
                <span class="tool-symbol" onclick="addTool('ğŸµ')">ğŸµ</span>
                <span class="tool-symbol" onclick="addTool('ğŸ€')">ğŸ€</span>
                <span class="tool-symbol" onclick="addTool('ğŸŒ±')">ğŸŒ±</span>
                <span class="tool-symbol" onclick="addTool('ğŸ§©')">ğŸ§©</span>
                <span class="tool-symbol" onclick="addTool('ğŸ”­')">ğŸ”­</span>
                <span class="tool-symbol" onclick="addTool('ğŸ—ºï¸')">ğŸ—ºï¸</span>
                <span class="tool-symbol" onclick="addTool('ğŸ­')">ğŸ­</span>
                <span class="tool-symbol" onclick="addTool('ğŸ–Œï¸')">ğŸ–Œï¸</span>
            </div>
            <div id="selectedTools"></div>
            <input type="text" id="customTool" placeholder="âœ¨ Ø£Ø¶Ù Ø£Ø¯Ø§Ø© Ù…Ø®ØµØµØ©">
            <button type="button" onclick="addCustomTool()">Ø¥Ø¶Ø§ÙØ© Ø£Ø¯Ø§Ø© Ù…Ø®ØµØµØ©</button>
            <textarea id="steps" placeholder="ğŸ‘£ Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø¯Ø±Ø³" rows="5"></textarea>
            <textarea id="activities" placeholder="ğŸ‹ï¸ Ø§Ù„Ø£Ù†Ø´Ø·Ø©" rows="5"></textarea>
        </form>
    </div>

    <div class="section">
        <h2>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Ø§Ù„Ø­Ø¶ÙˆØ±</h2>
        <input type="text" id="studentName" placeholder="ğŸ‘¤ Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨">
        <button onclick="addStudent()">â• Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨</button>
        <ul id="attendanceList"></ul>
    </div>

    <div class="section">
        <h2>ğŸ‘€ Ù…Ø¹Ø§ÙŠÙ†Ø©</h2>
        <div class="toolbar">
            <button onclick="applyStyle('bold')"><strong>ØºØ§Ù…Ù‚</strong></button>
            <button onclick="applyStyle('italic')"><em>Ù…Ø§Ø¦Ù„</em></button>
            <button onclick="applyStyle('underline')"><u>ØªØ³Ø·ÙŠØ±</u></button>
            <button onclick="applyStyle('justifyRight')">â‡</button>
            <button onclick="applyStyle('justifyCenter')">â†”</button>
            <button onclick="applyStyle('justifyLeft')">â‡’</button>
            <input type="number" id="fontSize" min="8" max="72" value="16" onchange="changeFontSize()">
            <input type="color" id="fontColor" onchange="changeFontColor()">
        </div>
        <div id="preview" class="preview" contenteditable="true"></div>
    </div>

    <div class="section">
        <button onclick="generatePreview()">ğŸ” Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¹Ø§ÙŠÙ†Ø©</button>
        <button onclick="resetForm()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬</button>
        <button onclick="saveLastInput()">ğŸ’¾ Ø­ÙØ¸ Ø¢Ø®Ø± Ø¥Ø¯Ø®Ø§Ù„</button>
        <button onclick="printForm()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬</button>
        <button onclick="printPreview()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©</button>
        <button onclick="exportToHTML()">ğŸ’» ØªØµØ¯ÙŠØ± Ø¥Ù„Ù‰ HTML</button>
        <button onclick="exportToDOCX()">ğŸ“„ ØªØµØ¯ÙŠØ± Ø¥Ù„Ù‰ DOCX</button>
    </div>

    <script>
        function generatePreview() {
            const preview = document.getElementById('preview');
            const form = document.getElementById('lessonPlanForm');
            let previewHTML = `
                <h2>ğŸ“š ${form.lessonTitle.value}</h2>
                <p><strong>ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®:</strong> ${form.lessonDate.value}</p>
                <p><strong>ğŸ“š Ø§Ù„Ù…Ø§Ø¯Ø©:</strong> ${form.subject.value}</p>
                <p><strong>ğŸ« Ø§Ù„ØµÙ:</strong> ${form.grade.value}</p>
                <p><strong>â° Ø§Ù„Ø­ØµØ©:</strong> ${form.classPeriod.value}</p>
                <h3>ğŸŒŸ Ø§Ù„Ù…Ù‚Ø¯Ù…Ø©</h3>
                <p>${form.introduction.value}</p>
                <h3>ğŸ¯ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù</h3>
                <p>${form.objectives.value}</p>
                <h3>ğŸ› ï¸ Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©</h3>
                <p>${Array.from(document.querySelectorAll('.selected-tool')).map(tool => tool.textContent).join(' ')}</p>
                <h3>ğŸ‘£ Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø¯Ø±Ø³</h3>
                <p>${form.steps.value}</p>
                <h3>ğŸ‹ï¸ Ø§Ù„Ø£Ù†Ø´Ø·Ø©</h3>
                <p>${form.activities.value}</p>
                <h3>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Ø§Ù„Ø­Ø¶ÙˆØ±</h3>
            `;

            const attendanceList = document.getElementById('attendanceList');
            if (attendanceList.children.length > 0) {
                previewHTML += '<ul>';
                for (let li of attendanceList.children) {
                    const studentName = li.textContent.split(' - ')[0];
                    const attendance = li.querySelector('select').value;
                    previewHTML += `<li>${studentName} - ${attendance}</li>`;
                }
                previewHTML += '</ul>';
            } else {
                previewHTML += '<p>Ù„Ù… ØªØªÙ… Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø§Ø¨.</p>';
            }

            preview.innerHTML = previewHTML;
        }

        function addStudent() {
            const studentName = document.getElementById('studentName').value;
            if (studentName) {
                const li = document.createElement('li');
                li.innerHTML = `
                    <span class="emoji">ğŸ‘¤</span> ${studentName} - 
                    <select>
                        <option value="Ø­Ø§Ø¶Ø±">âœ… Ø­Ø§Ø¶Ø±</option>
                        <option value="ØºØ§Ø¦Ø¨">âŒ ØºØ§Ø¦Ø¨</option>
                    </select>
                    <button onclick="this.parentElement.remove()">ğŸ—‘ï¸ Ø¥Ø²Ø§Ù„Ø©</button>
                `;
                document.getElementById('attendanceList').appendChild(li);
                document.getElementById('studentName').value = '';
            }
        }

        function resetForm() {
            document.getElementById('lessonPlanForm').reset();
            document.getElementById('attendanceList').innerHTML = '';
            document.getElementById('preview').innerHTML = '';
            document.getElementById('selectedTools').innerHTML = '';
        }

        function saveLastInput() {
            const lastInput = document.activeElement.value;
            localStorage.setItem('lastInput', lastInput);
            alert('ØªÙ… Ø­ÙØ¸ Ø¢Ø®Ø± Ø¥Ø¯Ø®Ø§Ù„! ğŸ’¾');
        }

        function applyStyle(style) {
            document.execCommand(style, false, null);
        }

        function changeFontSize() {
            const size = document.getElementById('fontSize').value;
            document.execCommand('fontSize', false, size);
        }

        function changeFontColor() {
            const color = document.getElementById('fontColor').value;
            document.execCommand('foreColor', false, color);
        }

        function printForm() {
            window.print();
        }

        function printPreview() {
            const previewContent = document.getElementById('preview').innerHTML;
            const win = window.open('', '_blank');
            win.document.write('<html><head><title>Ù…Ø¹Ø§ÙŠÙ†Ø© Ø®Ø·Ø© Ø§Ù„Ø¯Ø±Ø³</title></head><body style="direction: rtl;">');
            win.document.write(previewContent);
            win.document.write('</body></html>');
            win.document.close();
            win.print();
        }

        function exportToHTML() {
            const htmlContent = document.documentElement.outerHTML;
            const blob = new Blob([htmlContent], {type: 'text/html'});
            saveAs(blob, 'Ø®Ø·Ø©_Ø§Ù„Ø¯Ø±Ø³.html');
        }

        function exportToDOCX() {
            const previewContent = document.getElementById('preview').innerHTML;
            const doc = new docx.Document({
                sections: [{
                    properties: { 
                        page: {
                            rightToLeft: true,
                        },
                    },
                    children: [
                        new docx.Paragraph({
                            children: [new docx.TextRun(previewContent)],
                            bidirectional: true,
                        }),
                    ],
                }],
            });
            docx.Packer.toBlob(doc).then(blob => {
                saveAs(blob, 'Ø®Ø·Ø©_Ø§Ù„Ø¯Ø±Ø³.docx');
            });
        }

        function addTool(symbol) {
            const selectedTools = document.getElementById('selectedTools');
            const toolSpan = document.createElement('span');
            toolSpan.className = 'selected-tool';
            toolSpan.textContent = symbol;
            toolSpan.onclick = function() { this.remove(); };
            selectedTools.appendChild(toolSpan);
        }

        function addCustomTool() {
            const customTool = document.getElementById('customTool');
            if (customTool.value) {
                addTool(customTool.value);
                customTool.value = '';
            }
        }
    </script>
</body>
</html>
